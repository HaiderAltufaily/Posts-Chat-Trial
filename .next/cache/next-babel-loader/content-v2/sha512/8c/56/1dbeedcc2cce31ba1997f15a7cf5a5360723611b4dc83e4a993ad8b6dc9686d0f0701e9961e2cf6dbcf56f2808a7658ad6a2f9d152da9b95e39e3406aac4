{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/Udemy/nextjs/06-onwards-to-a-bigger-project-starting-project/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/Udemy/nextjs/06-onwards-to-a-bigger-project-starting-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"D:\\\\Udemy\\\\nextjs\\\\06-onwards-to-a-bigger-project-starting-project\\\\components\\\\meetups\\\\Reply.js\",\n    _s = $RefreshSig$();\n\nimport { Box, Flex, Text, IconButton } from \"@chakra-ui/react\";\nimport axios from \"axios\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { AiFillEdit } from \"react-icons/ai\";\nimport { CloseIcon } from \"@chakra-ui/icons\";\nimport { auth, db } from \"../../firebase/firebase\";\nimport { Spinner } from \"@chakra-ui/spinner\";\nimport { addDoc, collection, doc, getDoc, getDocs, query, where } from \"@firebase/firestore\";\nimport classes from \"./NewMeetupForm.module.css\";\n\nfunction Reply(_ref) {\n  _s();\n\n  var _auth$currentUser, _auth$currentUser2;\n\n  var reply = _ref.reply;\n\n  var _useState = useState({}),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(reply.content),\n      editValue = _useState2[0],\n      setEditValue = _useState2[1];\n\n  var _useState3 = useState(false),\n      edit = _useState3[0],\n      setEdit = _useState3[1];\n\n  var _useState4 = useState(false),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  useEffect(function () {\n    var isMounted = true;\n\n    function getUser() {\n      return _getUser.apply(this, arguments);\n    }\n\n    function _getUser() {\n      _getUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var x, response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(\"/api/\".concat(reply.user));\n\n              case 2:\n                x = _context.sent;\n                _context.next = 5;\n                return x.json();\n\n              case 5:\n                response = _context.sent;\n                if (isMounted) setUser(response);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _getUser.apply(this, arguments);\n    }\n\n    getUser();\n    return function () {\n      isMounted = false;\n    };\n  }, []);\n\n  function handleDelete() {\n    return _handleDelete.apply(this, arguments);\n  }\n\n  function _handleDelete() {\n    _handleDelete = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios[\"delete\"](\"/api/replies/\".concat(reply.id, \"/\").concat(reply.postId)).then(function (d) {\n                return console.log(\"aaa\", d.data);\n              })[\"catch\"](function (err) {\n                return console.log(err);\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _handleDelete.apply(this, arguments);\n  }\n\n  function handleEdit(_x) {\n    return _handleEdit.apply(this, arguments);\n  }\n\n  function _handleEdit() {\n    _handleEdit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n              _context3.next = 4;\n              return axios.put(\"/api/replies/\".concat(reply.id, \"/\").concat(reply.postId), {\n                content: editValue\n              }).then(function (d) {\n                return console.log(\"yess\", d.data);\n              });\n\n            case 4:\n              setLoading(false);\n              if (!loading) setEdit(false);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _handleEdit.apply(this, arguments);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    color: \"whiteAlpha.300\",\n    bg: ((_auth$currentUser = auth.currentUser) === null || _auth$currentUser === void 0 ? void 0 : _auth$currentUser.uid) === reply.user ? \"gray.400\" : \"gray.200\",\n    my: \"3\",\n    p: \"3\",\n    children: [((_auth$currentUser2 = auth.currentUser) === null || _auth$currentUser2 === void 0 ? void 0 : _auth$currentUser2.uid) === reply.user && /*#__PURE__*/_jsxDEV(Flex, {\n      justify: \"space-between\",\n      children: [/*#__PURE__*/_jsxDEV(IconButton, {\n        size: \"sm\",\n        onClick: function onClick() {\n          return setEdit(true);\n        },\n        textAlign: \"left\",\n        icon: /*#__PURE__*/_jsxDEV(AiFillEdit, {\n          size: \"23\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 19\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        size: \"sm\",\n        onClick: handleDelete,\n        icon: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 62\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), edit || /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        children: [\" \", user.username, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        fontWeight: \"semibold\",\n        fontSize: \"23\",\n        children: [\" \", reply.content, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this), edit && /*#__PURE__*/_jsxDEV(\"form\", {\n      className: classes.form,\n      onSubmit: handleEdit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.control,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          children: \"Edit Reply\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          value: editValue,\n          type: \"text\",\n          required: true,\n          id: \"title\",\n          onChange: function onChange(e) {\n            return setEditValue(e.target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.actions,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: loading,\n          children: loading ? /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 26\n          }, this) : \"Submit Changes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Reply, \"rnwleMqx3SwEHo/hAMkzdWCfnTg=\");\n\n_c = Reply;\nexport default Reply;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reply\");","map":{"version":3,"sources":["D:/Udemy/nextjs/06-onwards-to-a-bigger-project-starting-project/components/meetups/Reply.js"],"names":["Box","Flex","Text","IconButton","axios","React","useEffect","useRef","useState","AiFillEdit","CloseIcon","auth","db","Spinner","addDoc","collection","doc","getDoc","getDocs","query","where","classes","Reply","reply","user","setUser","content","editValue","setEditValue","edit","setEdit","loading","setLoading","isMounted","getUser","fetch","x","json","response","handleDelete","id","postId","then","d","console","log","data","err","handleEdit","e","preventDefault","put","currentUser","uid","username","form","control","fontWeight","target","value","actions"],"mappings":"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","sourcesContent":["import { Box, Flex, Text, IconButton } from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { AiFillEdit } from \"react-icons/ai\";\r\nimport { CloseIcon } from \"@chakra-ui/icons\";\r\nimport { auth, db } from \"../../firebase/firebase\";\r\nimport { Spinner } from \"@chakra-ui/spinner\";\r\nimport {\r\n  addDoc,\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  query,\r\n  where,\r\n} from \"@firebase/firestore\";\r\nimport classes from \"./NewMeetupForm.module.css\";\r\nfunction Reply({ reply }) {\r\n  const [user, setUser] = useState({});\r\n  const [editValue, setEditValue] = useState(reply.content);\r\n  const [edit, setEdit] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    async function getUser() {\r\n      const x = await fetch(`/api/${reply.user}`);\r\n      const response = await x.json();\r\n      if (isMounted) setUser(response);\r\n    }\r\n    getUser();\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, []);\r\n\r\n  async function handleDelete() {\r\n    await axios\r\n      .delete(`/api/replies/${reply.id}/${reply.postId}`)\r\n      .then((d) => console.log(\"aaa\", d.data))\r\n      .catch((err) => console.log(err));\r\n    // const q = query(\r\n    //   collection(db, \"posts\"),\r\n    //   where(\"replies\", \"array-contains\", reply)\r\n    // );\r\n    // const d = await getDocs(q);\r\n    // const data = await d.docs.map((doc) => doc.data());\r\n    // console.log(\"aa\", data);\r\n\r\n    // const d = (\r\n    //   await getDoc(\r\n    //     doc(db, \"message/SjVjF3dU5YoDKIAqTPYD/replies/q55nIyHOZUBUp089RUKM\")\r\n    //   )\r\n    // ).data();\r\n    // console.log(d);\r\n    // await addDoc(collection(db, `posts/${reply.postId}/reply`), reply);\r\n  }\r\n  async function handleEdit(e) {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    await axios\r\n      .put(`/api/replies/${reply.id}/${reply.postId}`, { content: editValue })\r\n      .then((d) => console.log(\"yess\", d.data));\r\n    setLoading(false);\r\n    if (!loading) setEdit(false);\r\n  }\r\n  return (\r\n    <Box\r\n      color=\"whiteAlpha.300\"\r\n      bg={auth.currentUser?.uid === reply.user ? \"gray.400\" : \"gray.200\"}\r\n      my=\"3\"\r\n      p=\"3\"\r\n    >\r\n      {auth.currentUser?.uid === reply.user && (\r\n        <Flex justify=\"space-between\">\r\n          <IconButton\r\n            size=\"sm\"\r\n            onClick={() => setEdit(true)}\r\n            textAlign=\"left\"\r\n            icon={<AiFillEdit size=\"23\" />}\r\n          />\r\n\r\n          <IconButton size=\"sm\" onClick={handleDelete} icon={<CloseIcon />} />\r\n        </Flex>\r\n      )}\r\n      {edit || (\r\n        <div>\r\n          <Text> {user.username} </Text>\r\n          <Text fontWeight=\"semibold\" fontSize=\"23\">\r\n            {\" \"}\r\n            {reply.content}{\" \"}\r\n          </Text>\r\n        </div>\r\n      )}\r\n      {edit && (\r\n        <form className={classes.form} onSubmit={handleEdit}>\r\n          <div className={classes.control}>\r\n            <label htmlFor=\"title\">Edit Reply</label>\r\n            <input\r\n              style={{ fontWeight: \"bold\" }}\r\n              value={editValue}\r\n              type=\"text\"\r\n              required\r\n              id=\"title\"\r\n              onChange={(e) => setEditValue(e.target.value)}\r\n            />\r\n          </div>\r\n          <div className={classes.actions}>\r\n            <button disabled={loading}>\r\n              {loading ? <Spinner /> : \"Submit Changes\"}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Reply;\r\n"]},"metadata":{},"sourceType":"module"}